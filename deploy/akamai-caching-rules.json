{
  "$schema": "https://developer.akamai.com/schemas/papi/v1/rules.json",
  "description": "Hugo Site Caching Rules for Akamai Property Manager - Full Site Migration",
  "rules": [
    {
      "name": "Hugo HTML Pages - News",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/news/*",
              "/news/press-releases/*",
              "/news/readouts/*",
              "/news/statements-remarks/*",
              "/news/testimonies/*",
              "/news/featured-stories/*",
              "/news/media-advisories/*",
              "/news/weekly-public-schedule/*",
              "/news/weekly-schedule-updates/*"
            ]
          }
        },
        {
          "name": "contentType",
          "options": {
            "matchOperator": "IS",
            "values": ["text/html"]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "5m",
            "mustRevalidate": true
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        }
      ]
    },
    {
      "name": "Hugo HTML Pages - About Section",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/about/*",
              "/about/general-information/*",
              "/about/offices/*",
              "/about/history/*",
              "/about/careers-at-treasury/*",
              "/about/budget-financial-reporting-planning-and-performance/*"
            ]
          }
        },
        {
          "name": "contentType",
          "options": {
            "matchOperator": "IS",
            "values": ["text/html"]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "15m",
            "mustRevalidate": true
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        }
      ]
    },
    {
      "name": "Hugo HTML Pages - Policy Issues",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/policy-issues/*",
              "/policy-issues/tax-policy/*",
              "/policy-issues/international/*",
              "/policy-issues/terrorism-and-illicit-finance/*",
              "/policy-issues/financing-the-government/*",
              "/policy-issues/consumer-policy/*",
              "/policy-issues/small-business-programs/*",
              "/policy-issues/economic-policy/*"
            ]
          }
        },
        {
          "name": "contentType",
          "options": {
            "matchOperator": "IS",
            "values": ["text/html"]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "15m",
            "mustRevalidate": true
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        }
      ]
    },
    {
      "name": "Hugo HTML Pages - Services & Data",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/services/*",
              "/data/*",
              "/resource-center/*"
            ]
          }
        },
        {
          "name": "contentType",
          "options": {
            "matchOperator": "IS",
            "values": ["text/html"]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "15m",
            "mustRevalidate": true
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        }
      ]
    },
    {
      "name": "Hugo Homepage",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/",
              "/index.html"
            ]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "5m",
            "mustRevalidate": true
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        }
      ]
    },
    {
      "name": "Static Assets - PDFs and Documents",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/system/files/*.pdf",
              "/system/files/*.PDF",
              "/system/files/*.doc",
              "/system/files/*.docx",
              "/system/files/*.xls",
              "/system/files/*.xlsx",
              "/system/files/*.ppt",
              "/system/files/*.pptx"
            ]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "30d"
          }
        },
        {
          "name": "prefreshCache",
          "options": {
            "enabled": true,
            "prefreshval": 90
          }
        }
      ],
      "comments": "Documents cached for 30 days"
    },
    {
      "name": "Hugo Static Assets (Fingerprinted)",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/css/*.*.css",
              "/js/*.*.js"
            ]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "365d",
            "honorPrivate": true,
            "honorNoStore": true
          }
        },
        {
          "name": "prefreshCache",
          "options": {
            "enabled": true,
            "prefreshval": 90
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        },
        {
          "name": "modifyOutgoingResponseHeader",
          "options": {
            "action": "MODIFY",
            "standardModifyHeaderAction": "ADD",
            "headerValue": "immutable",
            "newHeaderValue": "public, max-age=31536000, immutable"
          }
        }
      ]
    },
    {
      "name": "Hugo Images",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/images/*.webp",
              "/images/*.png",
              "/images/*.jpg",
              "/images/*.svg",
              "/system/files/*.jpg",
              "/system/files/*.jpeg",
              "/system/files/*.png",
              "/system/files/*.gif",
              "/system/files/*.svg"
            ]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "365d"
          }
        },
        {
          "name": "prefreshCache",
          "options": {
            "enabled": true,
            "prefreshval": 90
          }
        },
        {
          "name": "modifyOutgoingResponseHeader",
          "options": {
            "action": "MODIFY",
            "standardModifyHeaderAction": "ADD",
            "headerValue": "Accept",
            "newHeaderValue": "Vary"
          }
        }
      ],
      "comments": "Images cached for 1 year. WebP served when browser supports it."
    },
    {
      "name": "Fonts",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "MATCHES_ONE_OF",
            "values": [
              "/fonts/*.woff2",
              "/fonts/*.woff",
              "/fonts/*.ttf"
            ]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "MAX_AGE",
            "ttl": "365d"
          }
        },
        {
          "name": "modifyOutgoingResponseHeader",
          "options": {
            "action": "MODIFY",
            "standardModifyHeaderAction": "ADD",
            "headerValue": "Access-Control-Allow-Origin",
            "newHeaderValue": "*"
          }
        }
      ],
      "comments": "Fonts cached for 1 year with CORS support"
    },
    {
      "name": "Service Worker - No Cache",
      "criteria": [
        {
          "name": "path",
          "options": {
            "matchOperator": "IS",
            "values": ["/sw.js"]
          }
        }
      ],
      "behaviors": [
        {
          "name": "caching",
          "options": {
            "behavior": "NO_STORE"
          }
        }
      ],
      "comments": "Service worker should never be cached by CDN"
    },
    {
      "name": "Enable Brotli Compression",
      "criteria": [
        {
          "name": "contentType",
          "options": {
            "matchOperator": "IS_ONE_OF",
            "values": [
              "text/html",
              "text/css",
              "text/javascript",
              "application/javascript",
              "application/json",
              "image/svg+xml"
            ]
          }
        }
      ],
      "behaviors": [
        {
          "name": "brotli",
          "options": {
            "enabled": true
          }
        },
        {
          "name": "gzipResponse",
          "options": {
            "behavior": "ALWAYS"
          }
        }
      ],
      "comments": "Brotli first, gzip fallback for text-based content"
    }
  ],
  "origin_routing": {
    "description": "Path-based routing for Hugo migration",
    "hugo_paths": [
      "/",
      "/about/*",
      "/policy-issues/*",
      "/services/*",
      "/data/*",
      "/resource-center/*",
      "/news/*",
      "/css/*",
      "/js/*",
      "/images/*",
      "/fonts/*",
      "/system/files/*"
    ],
    "drupal_fallback": "All other paths route to Drupal origin"
  }
}
