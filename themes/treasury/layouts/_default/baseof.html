<!DOCTYPE html>
<html lang="{{ site.LanguageCode | default "en" }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>{{ if .IsHome }}{{ site.Title }}{{ else }}{{ .Title }} | {{ site.Title }}{{ end }}</title>
  
  {{- with .Description | default site.Params.description }}
  <meta name="description" content="{{ . }}">
  {{- end }}
  
  <!-- Open Graph -->
  <meta property="og:title" content="{{ .Title }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  {{- with .Params.image }}
  <meta property="og:image" content="{{ . | absURL }}">
  {{- end }}
  <meta property="og:site_name" content="{{ site.Title }}">
  
  <!-- Fonts - self-hosted (no external CDN dependency) -->
  {{- $fonts := resources.Get "css/fonts.css" }}
  {{- $fonts = $fonts | minify | fingerprint }}
  <link rel="preload" href="{{ $fonts.RelPermalink }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ $fonts.RelPermalink }}"></noscript>
  
  <!-- Preload critical fonts -->
  <link rel="preload" href="/fonts/source-sans-pro-400.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/merriweather-700.woff2" as="font" type="font/woff2" crossorigin>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="{{ "images/favicon.png" | relURL }}">
  
  <!-- Critical CSS - inlined for faster first paint -->
  {{- partial "critical-css.html" . }}
  
  <!-- Main Styles - loaded async with fingerprinting for cache busting -->
  {{- $css := resources.Get "css/treasury.css" }}
  {{- $css = $css | minify | fingerprint }}
  <link rel="preload" href="{{ $css.RelPermalink }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ $css.RelPermalink }}"></noscript>
  
  <!-- Canonical -->
  <link rel="canonical" href="{{ .Permalink }}">
  
  {{- block "head" . }}{{- end }}
</head>
<body class="treasury-site">
  <!-- Skip nav -->
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <!-- Alert Banner -->
  {{- partial "alert-banner.html" . }}
  
  <!-- USA Banner -->
  {{- partial "usa-banner.html" . }}
  
  <!-- Header + Navigation -->
  {{- partial "header.html" . }}
  
  <!-- Main content -->
  <main id="main-content">
    {{- block "main" . }}{{- end }}
  </main>
  
  <!-- Footer -->
  {{- partial "footer.html" . }}
  
  <!-- Scripts - deferred & fingerprinted for caching -->
  {{- $js := resources.Get "js/treasury.js" }}
  {{- $js = $js | minify | fingerprint }}
  <script src="{{ $js.RelPermalink }}" defer></script>
  {{- block "scripts" . }}{{- end }}
  
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js').catch(function(err) {
          console.log('SW registration failed:', err);
        });
      });
    }
  </script>
  
</body>
</html>
