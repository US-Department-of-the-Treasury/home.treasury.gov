{{ define "main" }}
{{/* Redirect /news/ to /news/press-releases/ */}}
{{ if eq .RelPermalink "/news/" }}
<script>window.location.replace("/news/press-releases/");</script>
<meta http-equiv="refresh" content="0; url=/news/press-releases/">
{{ else }}
<div class="breadcrumbs">
  <div class="container">
    <nav aria-label="Breadcrumb">
      <ol class="breadcrumbs-list">
        <li><a href="https://home.treasury.gov/">HOME</a></li>
        <li><a href="/news/">NEWS</a></li>
        <li><span aria-current="page">{{ .Title | upper }}</span></li>
      </ol>
    </nav>
  </div>
</div>

<div class="news-page-section">
  <div class="container">
    <div class="news-three-col">
      {{/* Left Sidebar */}}
      {{ partial "news-sidebar.html" . }}
      
      {{/* Main Content */}}
      <main class="news-main-content">
        <header class="news-page-header">
          <h1 class="page-title">{{ .Title }}</h1>
          <div class="title-underline"></div>
        </header>
        
        {{ if .Content }}
        <div class="news-intro">
          {{ .Content }}
        </div>
        {{ end }}
        
        <div class="news-article-list">
          {{/* Filter pages based on section - exclude Readouts/Statements/Testimonies from Press Releases */}}
          {{ $pages := .Pages }}
          {{ if eq .Title "Press Releases" }}
            {{ $filtered := slice }}
            {{ range .Pages }}
              {{ $title := .Title }}
              {{ $isReadout := hasPrefix $title "Readout" }}
              {{ $isREADOUT := hasPrefix $title "READOUT" }}
              {{ $isStatement := hasPrefix $title "Statement" }}
              {{ $isTestimony := hasPrefix $title "Testimony" }}
              {{ if not (or $isReadout $isREADOUT $isStatement $isTestimony) }}
                {{ $filtered = $filtered | append . }}
              {{ end }}
            {{ end }}
            {{ $pages = $filtered }}
          {{ end }}
          {{ $paginator := .Paginate $pages 10 }}
          {{ range $paginator.Pages }}
          <article class="news-article-item">
            <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
            {{/* Display category tags */}}
            {{ if .Params.category }}
            <span class="article-category"><a href="/news/{{ .Params.category | urlize }}/">{{ .Params.category }}</a></span>
            {{ else }}
              {{ with .Params.categories }}
                {{ with index . 0 }}
                <span class="article-category"><a href="/news/{{ . | urlize }}/">{{ . }}</a></span>
                {{ end }}
              {{ end }}
            {{ end }}
            <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
          </article>
          {{ end }}
        </div>
        
        {{/* Pagination - Treasury.gov style (inline, no left arrow, ellipsis) */}}
        {{ if gt $paginator.TotalPages 1 }}
        <nav class="pagination" aria-label="Pagination">
          {{ $currentPage := $paginator.PageNumber }}
          {{ $totalPages := $paginator.TotalPages }}
          
          {{/* First few pages */}}
          {{ range $paginator.Pagers }}
            {{ $pageNum := .PageNumber }}
            {{/* Show pages 1-3 always */}}
            {{ if le $pageNum 3 }}
              {{ if eq $pageNum $currentPage }}
              <span class="page-number current" aria-current="page">{{ $pageNum }}</span>
              {{ else }}
              <a href="{{ .URL }}" class="page-number">{{ $pageNum }}</a>
              {{ end }}
            {{ end }}
          {{ end }}
          
          {{/* Ellipsis if needed */}}
          {{ if gt $totalPages 4 }}
          <span class="page-ellipsis">...</span>
          {{ end }}
          
          {{/* Next Arrow only */}}
          {{ if $paginator.HasNext }}
          <a href="{{ $paginator.Next.URL }}" class="page-arrow next" aria-label="Next page">â†’</a>
          {{ end }}
        </nav>
        {{ end }}
      </main>
      
      {{/* Right Sidebar - Keyword Search */}}
      {{ partial "news-search-sidebar.html" . }}
    </div>
  </div>
</div>
{{ end }}
{{ end }}
